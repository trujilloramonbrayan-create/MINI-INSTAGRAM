<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="goBack()">
        <ion-icon name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Nueva Publicación</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="createPost()" [disabled]="!selectedImage">
        <ion-icon name="checkmark"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-card>
    <ion-card-content>
      <!-- Preview de la imagen -->
      <div class="image-preview" *ngIf="imagePreview">
        <img [src]="imagePreview" alt="Preview">
      </div>

      <!-- Botón para seleccionar imagen -->
      <div class="image-selector" *ngIf="!imagePreview">
        <ion-button expand="block" (click)="fileInput.click()">
          <ion-icon name="image" slot="start"></ion-icon>
          Seleccionar Imagen
        </ion-button>
        <input 
          #fileInput 
          type="file" 
          accept="image/*" 
          (change)="onFileSelected($event)" 
          class="hidden-input"
          title="Seleccionar una imagen">
      </div>

      <!-- Cambiar imagen si ya hay una seleccionada -->
      <div class="change-image" *ngIf="imagePreview">
        <ion-button fill="outline" size="small" (click)="fileInput.click()">
          Cambiar Imagen
        </ion-button>
        <input 
          #fileInput 
          type="file" 
          accept="image/*" 
          (change)="onFileSelected($event)" 
          class="hidden-file-input"
          title="Seleccionar una imagen">
      </div>

      <!-- Caption -->
      <ion-textarea
        placeholder="Escribe una descripción..."
        [(ngModel)]="caption"
        rows="4"
        class="ion-margin-top">
      </ion-textarea>
    </ion-card-content>
  </ion-card>
</ion-content>